# LLMエージェント協調プロセス柔軟化要件定義

## 1. 目的

LLMエージェント間の協調プロセスを、コードの変更なしに外部設定で柔軟に定義・変更できるようにすることで、多様なエージェント分業モデルの実験と拡張を可能にする。

## 2. スコープ

*   エージェントのロール定義の外部化。
*   エージェント間の対話フロー（ステップ、繰り返し、条件分岐）の外部化。
*   `src/agent.ts` のプロセス知識からの分離。

## 3. 機能要件

### 3.1. ロール定義の外部化

*   各エージェントの役割（システムプロンプト、IDなど）を**プロンプト定義ファイル**（例: `prompts/default_prompts.json`）または専用の設定ファイルで定義できること。
*   `src/agent.ts` は、定義されたロールIDに基づいてエージェントをインスタンス化できること。

### 3.2. 対話フローの外部化

*   エージェント間の対話の順序、繰り返し回数、各ステップで使用するプロンプトID、次のステップへの遷移条件などを、外部設定ファイル（例: `config/workflow_config.json`）で定義できること。
*   `src/agent.ts` は、定義されたフローに従ってエージェント間の対話をオーケストレーションできること。
*   基本的な逐次実行だけでなく、将来的に条件分岐や並列実行などの複雑なフローも定義できるような拡張性を持つこと。

### 3.3. プロンプトの参照

*   フロー定義内で、**プロンプト定義ファイル**に定義されたプロンプトIDを参照できること。

## 4. 非機能要件

*   **柔軟性**: コードの変更なしに、新しいロールや対話フローを容易に追加・変更できること。
*   **保守性**: プロセスロジックとプロンプト定義が分離されることで、コードの保守性が向上すること。
*   **パフォーマンス**: 外部設定の読み込みによる顕著なパフォーマンス劣化がないこと。

## 5. 実装対象ファイル

*   `src/agent.ts` (コアロジックの変更)
*   `src/index.ts` (設定ファイルの読み込み、`src/agent.ts` への連携)
*   **プロンプト定義ファイル**（例: `prompts/default_prompts.json`）(ロール定義の追加)
*   新規設定ファイル（例: `config/workflow_config.json`）

## 6. 今後の検討事項

*   フロー定義の具体的なスキーマ（JSONスキーマなど）。
*   条件分岐や並列実行などの複雑なフローの表現方法。
*   エラーハンドリングとリカバリ戦略。