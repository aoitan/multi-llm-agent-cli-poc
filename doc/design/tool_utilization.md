# エージェントの能力拡張（手足・五感）設計書

## 概要

本機能は、LLMのテキスト生成能力だけでは不可能な、実世界とのインタラクションを可能にする。これにより、エージェントは外部ツールを利用して情報を取得したり、アクションを実行したりできるようになる。

## 主要機能

### 1. ツールの利用（Function Calling）

- **目的**: エージェントが外部APIやローカルの関数を「ツール」として呼び出すための仕組みを提供する。
- **詳細**: 
    - LLMが特定の形式（例: JSON）でツール呼び出しを指示するプロンプトを生成する。
    - システムがその指示を解析し、対応するツールを実行する。
    - ツールの実行結果をLLMにフィードバックする。
- **入力**: LLMからのツール呼び出し指示、ツールの引数
- **出力**: ツールの実行結果

#### 1.1. 必須ツール例

- **Web検索**: インターネットから最新の情報や特定のデータを取得する。
- **ファイル読み書き**: ローカルファイルシステム上のファイルを読み込んだり、書き込んだりする。
- **コード実行・テスト**: 生成したコードを実行し、その結果やテストの合否を確認する。

#### 1.2. 応用ツール例

- **データベース接続**: データベースから情報を取得したり、データを操作したりする。
- **外部API連携**: 外部サービス（例: GitHub, Jira）のAPIを呼び出し、情報を取得したり、アクションを実行したりする。

## 実装方針

- ツールは、LLMが理解しやすいように、明確な説明と引数の定義を持つインターフェースとして提供する。
- ツール実行の安全性とエラーハンドリングを考慮する。
- ツール呼び出しのログを記録し、デバッグや監査に利用できるようにする。

## 考慮事項

- ツールの種類と数が増えた場合の管理の複雑さ。
- LLMがツールを適切に利用するためのプロンプトエンジニアリングの難しさ。
- ツール実行時のセキュリティリスク（特にコード実行やファイル操作）。
    - **対策例**:
        - サンドボックス環境でのコード実行により、外部への影響を最小限に抑える。
        - ツールごとにアクセス権限や実行権限を厳格に制御する。
        - 入力値のバリデーションやサニタイズ処理を徹底し、不正なデータの混入を防ぐ。
        - 実行ログの記録と監査を行い、異常な挙動を早期に検知する。
        - 外部APIやファイル操作時には、必要最小限の権限のみを付与する。
