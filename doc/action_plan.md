# 対応計画

## 1. PoCの目的と背景の明確化

- **最終ゴール**: 複数LLMの協調動作能力と任意LLMを用いたCLIエージェント機能の提供。
- **現時点のPoCの焦点**: 複数LLMの協調動作が価値あるものかの実験的検証。
- **検証仮説**: 複数のローカルLLMを協調させることで、個別LLMの制約を超えるアウトプットが得られるか。
- **評価軸**: 文脈処理能力、専門性、推論力、出力品質の超越。

## 2. 現状のPoCの限界と機能追加のモチベーション

- **現状の限界**: Ping-Pong的応答、役割・記憶の維持困難、履歴・状態管理なし、CLI UX未整備。
- **モチベーション**: 「超越」の検証には状態・履歴・ロール認識の維持が不可欠。アンサンブルや分担処理の検証にはルーティングや複数応答の仕組みが必要。

## 3. 追加すべき主要機能一覧

### 3.1. 🧠 エージェントごとのコンテキスト管理

- 会話履歴の保持（per LLM）
- 内部メモリの保持
- プロンプトテンプレートによる役割固定

### 3.2. 🗣️ 発話制御とルーティング

- 会話ターン管理
- 発話の宛先指定
- 自動発話トリガー

### 3.3. 📚 セッション管理と永続化

- セッション履歴の構造化
- 状態復元機能
- 発話ログの出力

### 3.4. 🤝 協調動作の支援機構

- 並列発話（アンサンブル）
- 分担処理と統合
- 中央調停者（Coordinator）導入

### 3.5. 💬 CLIユーザー体験の改善

- 発話元の明示（prefix/色）
- 状態の可視化（発話中・応答中など）
- 宛先指定UIの追加（入力ルーティング）

## 4. 今後の設計方針

- まずは最低限のコンテキスト保持とターン制御を導入し、初期的な協調の実現を目指す。
- 中間評価で「単体能力の超越」が観察されたかを定性・定量で記録。
- 成果を本体 MultiOllamaAgentCLI のアーキテクチャに引き継ぐ。

## 5. 機能ごとの設計書作成

以下の機能について、`doc/design/`ディレクトリに個別の設計書（Markdown形式）を作成します。

- **統括・実行管理機能（司令塔：オーケストレーター）**
    - タスク分解・計画機能
    - タスク割り当て機能
    - 状態管理機能
- **コンテキスト・情報共有の仕組み（神経系）**
    - 共有ワークスペース
    - コンテキスト管理・最適化機能
- **エージェントの能力拡張（手足・五感）**
    - ツールの利用（Function Calling）
        - Web検索
        - ファイル読み書き
        - コード実行・テスト
        - データベース接続
        - 外部API連携
