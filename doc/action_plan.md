# 対応計画

## 1. PoCの目的と背景の明確化

- **最終ゴール**: 複数LLMの協調動作能力と任意LLMを用いたCLIエージェント機能の提供。
- **現時点のPoCの焦点**: 複数LLMの協調動作が価値あるものかの実験的検証。
- **検証仮説**: 複数のローカルLLMを協調させることで、個別LLMの制約を超えるアウトプットが得られるか。
- **評価軸**: 文脈処理能力、専門性、推論力、出力品質の超越。

## 2. 現状のPoCの限界と機能追加のモチベーション

- **現状の限界**: Ping-Pong的応答、役割・記憶の維持困難、履歴・状態管理なし、CLI UX未整備。
- **モチベーション**: 「超越」の検証には状態・履歴・ロール認識の維持が不可欠。アンサンブルや分担処理の検証にはルーティングや複数応答の仕組みが必要。

## 3. MVPフェーズで進めるべき優先機能

PoC評価を進めるために、まずは以下の機能だけに絞って実装を進めることを強くおすすめします。

1.  **エージェントごとの履歴／内部メモ管理**
    *   ロールを持ったエージェントの対話が再現可能になる。
2.  **明示的な発話ターン制御と宛先指定（手動式でOK）**
    *   協調構造を確認できる最低限ルーティング。
3.  **アンサンブル取得の簡易実装**
    *   同一タスクに対して2～3つのエージェントの応答を比較できる。
4.  **最低限のプロンプトテンプレート（システムプロンプト）**
    *   各エージェントが役割を自律認識しやすくなる。

## 4. 今後の設計方針

-   MVPフェーズでは、上記の優先機能に絞って実装を進める。
-   中間評価で「単体能力の超越」が観察されたかを定性・定量で記録。
-   MVPフェーズ完了後、セッション永続化、履歴のファイル化、UI改善、Coordinatorのような中央制御エージェント、自動トリガーなどの機能拡張を検討する。
-   成果を本体 MultiOllamaAgentCLI のアーキテクチャに引き継ぐ。

## 5. 機能ごとの設計書作成

MVPフェーズで優先する機能について、`doc/design/`ディレクトリに個別の設計書（Markdown形式）を作成します。

-   **エージェントごとのコンテキスト管理**
    -   会話履歴の保持（per LLM）
    -   内部メモリの保持
    -   プロンプトテンプレートによる役割固定
-   **発話制御とルーティング**
    -   会話ターン管理
    -   発話の宛先指定
-   **協調動作の支援機構**
    -   並列発話（アンサンブル）

