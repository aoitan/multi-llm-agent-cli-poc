# ストーリー 7.2: エージェントモジュールの責務分割と API 整合性回復

## 概要
ワークフロー実行の中心となる `src/agent.ts` の責務が肥大化しているため、モジュール分割と API 整合性の回復を行います。また、`conductConsultation` など存在しないエクスポートに依存する CLI を修正し、TypeScript アプリケーション全体で一貫した API を提供します。

## 受け入れ条件
- [ ] `src/agent.ts` の主要機能 (エージェント構築、ワークフロー制御、言語ガード、テンプレート処理) がモジュール単位に分割され、各モジュールに対する単体テストが整備されている。
- [ ] `cooperativeAgentEval.ts` / `singleAgentEval.ts` が実在する API を呼び出すように修正され、ビルドエラーが無い。
- [ ] シナリオ設定ローダーの重複 (`promptLoader` と `scenarioIdentifier`) が解消され、単一の共有実装に統合されている。
- [ ] コード分割後のエクスポート構造が README などで説明され、開発者が利用方法を把握できる。

## 進め方のガイド
- 現行の `Agent` クラスとワークフロー制御ロジックを、それぞれ `agents/`, `workflow/`, `guards/` などのディレクトリに切り出すことを検討してください。
- 既存テストがカバーできていない箇所は、ストーリー 7.1 のテスト強化と連携して補完します。
- API 変更が伴う場合は、CLI やスクリプトへの影響範囲を洗い出し、後方互換性を確認してください。

## 関連タスク
* [ ] [タスク 7.2.1: cooperativeAgentEval の API 整合性修正](task_7_2_1_fix_cooperative_api_usage.md)
* [ ] [タスク 7.2.2: agent.ts の責務分割とユーティリティ化](task_7_2_2_refactor_agent_module.md)
* [ ] [タスク 7.2.3: シナリオ設定ローダーの共通化](task_7_2_3_unify_scenario_config_loader.md)

## 依存関係 / リスク
- モジュール分割により import パスが変わるため、関連ファイルの更新漏れに注意。
- CLI スクリプトに破壊的変更が及ぶ場合は、ストーリー 7.3 との調整が必要。
