# タスク 10.2.1: agent.ts の責務分割とインフラテスト追加

## 概要
`src/agent.ts` に LLM クライアント、ワークフロー状態機械、テンプレート処理が集中しており、保守性が低下しています。責務ごとにモジュール化し、基礎的な単体テストを追加します。

## 目的
コードベースを理解しやすくし、将来的な機能追加やテスト拡張を容易にする。

## 受け入れ条件
- [ ] `Agent` (LLM クライアント) / ワークフロー実行 / テンプレート補完が別ファイルに分割されている。
- [ ] 各モジュールに対応する単体テストが追加され、カバレッジが向上している。
- [ ] 既存の公開 API (`orchestrateWorkflow`, `runEnsemble`, `fillTemplate`) を利用する呼び出し元が移行済みで、挙動差がない。

## 作業手順
1. [ ] 現行コードを分析し、分割すべき関心ごとを特定する。
2. [ ] 新しいファイル構造を作成し、TypeScript 型や依存関係を調整する。
3. [ ] `jest` ベースの単体テストを追加し、モックを活用して副作用を隔離する。
4. [ ] `npm test` および `npm run lint` を実行して問題が無いことを確認する。

## 検証 / テスト
- `npm run lint`
- `npm test`

## アウトプット
- 分割された TypeScript モジュール
- 追加されたテストファイル
- 更新されたインポートパス

## 関連情報
- ストーリー 10.2
- 既存のテストユーティリティ
