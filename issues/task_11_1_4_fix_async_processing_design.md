# タスク: 非同期処理設計の改善

## 概要
Promise内でのコールバック使用による複雑なエラーハンドリングを整理し、async/await パターンに統一します。

## 背景 / きっかけ
- `src/agent.ts:L77-L98`でPromise内コールバック使用によりエラーハンドリングが複雑化
- 非同期処理の一貫性がなく保守性が低下
- デッドロックやレスポンス漏れのリスクが存在

## 実装内容
- [ ] `Agent.sendMessage`メソッドのasync/await化
- [ ] `chatWithOllama`のPromise化（コールバック廃止）
- [ ] `orchestrateWorkflow`の非同期処理統一
- [ ] エラーハンドリングの一元化
- [ ] タイムアウト処理の統一

## 受け入れ条件
- [ ] 全非同期処理がasync/awaitパターンに統一される
- [ ] エラーハンドリングが一貫性を持つ
- [ ] 既存機能の動作が変更されない
- [ ] 非同期処理のテストが追加される
- [ ] デッドロック等の問題が解決される

## 優先度
High - アーキテクチャ改善

## 作業工数見積もり
4-5 時間

## 関連ファイル
- `src/agent.ts` (非同期処理全般)
- `src/ollamaApi.ts` (API呼び出し)
- `src/__tests__/` (非同期テスト)

## 設計原則
- Promise over Callback
- 統一的エラーハンドリング
- 適切なタイムアウト設定
- リソースリーク防止

## 関連タスク
- task_11_1_2 (外部API抽象化)
- task_11_1_3 (異常系テスト拡充)